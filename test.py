#!/usr/bin/python

import os;
os.system('objdump -d ret2esp | grep "ff e4" > dump');

for line in open('dump', 'r'):
    if 'ff e4' in line:
        print(line)
			
		
print(len(line)) #804843f:	c7 45 f4 ff e4 00 00 	movl   $0xe4ff,-0xc(%ebp)

x=line.find(':')+2 #Index of First Opcode

y=line.find('ff e4') #Index of first occurence of 'ff e4'
z=int((y-x)/3) #Seperation between both
addr = line[0:(x-2)] #Address of the First opcode in HEX
a1=int(hex(int(addr,16)),16)
a2=int(hex(z),16)
addr_esp=hex(a1+a2)
print(addr_esp) #Address of FF E4

