import os
import sys


def isVulnerable(binaryName):
	#binaryName= sys.argv[1]
		
	disass_dump = 'objdump -d '+binaryName +'> objdump'	#'| grep "ff e4" > objdumpfile'
	os.system(disass_dump) #'objdump -d ret2esp | grep "ff e4" > objdumpfile.txt'
	
	# Check if The Binary has jmp *%esp vulnerabality .
	if(not os.system('cat objdump | grep "ff e4"')):	
		print('This Binary can be exploited using jmp *%esp\n')
	else:
		print('jmp *%esp vulnerability Not found. Need futher Investigation\n')
	
	# Check if The Binary has call *%eax vulnerabality
	if(not os.system('cat objdump | grep "*%eax"')):
		print('This Binary can be exploited using call *%eax\n')
	else:
		print('jmp *%esp vulnerability Not found. Need futher Investigation')


#isVulnerable()
